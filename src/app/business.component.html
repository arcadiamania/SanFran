<!--h1>Biz Directory</h1>

<h2>There are {{ business_list.length }} businesses in the directory</h2>
 
 <h2>The first business is {{ business_list[0].name }}</h2>
 
 <div *ngFor="let business of business_list">
	 <p>Name: {{ business.name }} <br>
	 City: {{ business.city }} <br>
	 Reviews: {{ business.review_count }}
	 </p>
</div-->


<!--div class="jumbotron">
	<h1>Biz Directory</h1>
</div-->
<div class="container" style="margin-top:100px;">
	<div class="row">
		<div class="col-sm-12">
			<div *ngFor = "let business of webService.b_id.list | async"><!--C3, from michel email-->
				<div class="card text-white bg-primary mb-3"
					[routerLink]="['/businesses', business._id]"
					style="cursor: pointer"><!--C1,19-->
					<div class="card-header">
						{{ business.business_name }}
					</div>
					<div class="card-body">
						Location: {{ business.business_address }}, {{ business.business_city }}, {{ business.business_postal_code }}
					</div>
					<div class="card-body">
						<div class="mapouter">
							<div class="gmap_canvas">
								<iframe width="400" height="400" id="gmap_canvas" [src]="sanitizer.bypassSecurityTrustResourceUrl(business.business_location)" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
								<!--a href="https://www.whatismyip-address.com">show me where i am now</a-->
							</div>
							<style>.mapouter{position:relative;text-align:right;height:400px;width:400px;}.gmap_canvas {overflow:hidden;background:none!important;height:400px;width:400px;}</style>
						</div>
					</div>
					<div class="card-footer">
						Showing {{ business.review_count }}
						reviews available
					</div>
					<!--Could add more but nahh-->
				</div>
			</div>
		</div> <!-- col -->
	</div> <!-- row -->
</div> <!-- container -->

<div class="row">
	<div class="col-sm-12">
		<div class="card bg-light mb-3" *ngFor = "let review of webService.r.list | async">
			<div class="card-header">
				{{ review.stars }} ‚≠ê review from {{ review.username }}
					on {{ review.date | date }}
			</div>
			<div class="card-body">
				{{ review.text }}
			</div>
			<div class="card-footer">
				<div class="btn-group btn-group-toggle" data-toggle="buttons">
				  <label class="btn btn-outline-success"><!--###Add angular class here with 'active' class -->
					<input type="radio" name="options" id="upVote" autocomplete="off" checked> {{ review.votes.up }} üëç
				  </label>
				  <label class="btn btn-outline-secondary">
					<input type="radio" name="options" id="downVote" autocomplete="off"> {{ review.votes.down }} üëé
				  </label>
				</div>
			</div>
		</div>
	</div>
</div>

<nav aria-label="Page navigation example">
  <ul class="pagination">
    <li class="page-item" *ngFor = "let pageNav of webService.r.navPages">
		<a
			class="page-link"
			(click)="changePage(pageNav)"
			[ngClass]="{'':pageCheck(pageNav)}"
		>
			{{pageNav.pageText}}
		</a>
	</li>
    <!--li class="page-item"><a class="page-link" href="#">1</a></li>
    <li class="page-item"><a class="page-link" href="#">2</a></li>
    <li class="page-item"><a class="page-link" href="#">3</a></li>
    <li class="page-item"><a class="page-link" href="#">Next</a></li-->
  </ul>
</nav>


<div class="row">
	<div class="col-sm-6">
		<button class="btn btn-primary" (click)="previousPage()">Previous</button>
	</div>
	<div class="col-sm-6 text-right">
		<button class="btn btn-primary" (click)="nextPage()">Next</button>
	</div>
</div>




<div *ngIf="authService.loggedIn" class="container"><!--c4 7-->
	<div class="row">
		<div class="col-sm-12">
			<h2>Please review this business</h2>
			<form [formGroup]="reviewForm" (ngSubmit)="onSubmit()">
				<div class="form-group">
					<label for="name">Name</label>
					<input type="text" id="name" name="name" class="form-control" formControlName="name"
						[ngClass]="{'error': isInvalid('name')}"
					>
				</div>
				<div class="form-group">
					<label for="review">Please leave your review below</label>
					<textarea id="review" rows="3" name="review" class="form-control" formControlName="review"
						[ngClass]="{'error': isInvalid('review')}"
					></textarea>
				</div>
				<div class="form-group">
					<label for="stars">Please provide a rating (5 = best)</label>
					<select id="stars" name="stars" class="form-control" formControlName="stars">
						<option value="1">1 star</option>
						<option value="2">2 stars</option>
						<option value="3">3 stars</option>
						<option value="4">4 stars</option>
						<option value="5">5 stars</option>
					</select>
				</div>
				<span *ngIf="isIncomplete()">You must complete all fields</span>
				<button *ngIf="!isIncomplete()" type="submit" class="btn btn-primary">Submit</button>
			</form>
		</div>
	</div>
</div>

<div *ngIf="!authService.loggedIn" class="container">
	<div class="row">
		<div class="col-sm-12">
			<h2>Please login to review this business</h2>
		</div>
	</div>
</div>